[[extend 'layout.html']]

<style>
[v-cloak] {
    display: none;
}
</style>

<div class="section" id="app" v-cloak>
    <div class="content">
        <h1 class="title"><i class="fa-solid fa-location-dot"></i> Region: {{region}}</h1>
    </div>
    <div class="columns">
        <div class="column is-half">
            <div class="card pb-2">
                <div class="card-content">
                    <h1 class="title">Most Common Species</h1>
                    <table class="table is-fullwidth is-hoverable is-striped">
                        <tr>
                            <th></th>
                            <th>Bird Species</th>
                            <th>Sightings</th>
                        </tr>
                        <tr v-for="(bird, row) in selected_species" :key="row">
                            <th>{{(page_number - 1) * items_per_page + row + 1}}</th>
                            <td class="is-clickable" @click="display_location_data(bird.sightings.id)">{{bird.sightings.name}}</td>
                            <td>{{bird.count}}</td>
                        </tr>
                    </table>
                    <nav class="pagination is-right is-rounded is-small" role="navigation" aria-label="pagination">
                        <ul class="pagination-list">
                            <button 
                            class="button pagination-previous"
                            :disabled="first_page"
                            @click="update_page(-1)"
                            >
                                Previous
                            </button>
                            <button 
                            class="button pagination-next"
                            :disabled="last_page"
                            @click="update_page(1)"
                            >
                                Next
                            </button>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
        <div class="column is-half">
            <div class="card">
                <div class="card-content">
                    <h1 class="title">Top Contributors</h1>
                    <table class="table is-fullwidth is-hoverable is-striped">
                        <tr>
                            <th>Observer</th>
                            <th>Number of Bird Species observed</th>
                            <th>Total Time Spent Observing</th>
                        </tr>
                        <tr v-for="contributor in top_contributors">
                            <th>{{contributor.observer_id}}</th>
                            <td>{{contributor.count}}</td>
                            <td>{{contributor.duration}}</td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="card mt-2">
                <div class="card-content">
                    <div class="columns">
                        <div class="column has-text-centered">
                            <strong>Checklist Number</strong>
                            <p>{{checklist_num}}</p>
                        </div>
                        <div class="column has-text-centered">
                            <strong>Number of Sightings</strong>
                            <p>{{num_sightings}}</p>
                        </div>
                    </div> <!-- Closing for the inner columns div -->
                </div>
            </div> <!-- Closing for the card mt-4 div -->
        </div> <!-- Closing for the column is-half div -->
    </div> <!-- Closing for the columns div -->
    <div class="columns is-centered">
        <div class="column is-half">
            <div class="card">
                <div class="card-content has-text-centered">
                    <h1 class="title">Monthly Data Radar Chart</h1>
                    <div style="width: 400px; height: 400px; margin: 0 auto;">
                        <canvas id="radarChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <div class="column is-half">
            <div class="card">
                <div class="card-content has-text-centered">
                    <h1 class="title">{{bird_chart_label_name}} Time Graph</h1>
                    <canvas id="birdChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div> <!-- Closing for the section div -->

[[block page_scripts]]
<!-- Loads the index-specific js for Vue -->
<script>
    let my_callback_url = "[[=XML(my_callback_url)]]";
    let get_species_url = "[[=XML(get_species_url)]]";
    let get_radar_data_url = "[[=XML(get_radar_data_url)]]";
    let display_location_data_url = "[[=XML(display_location_data_url)]]";
</script>
<script src="js/location.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
[[end]]
